function [phi, u, w] = FentonU(k0, h, a, modeNo, theta, z)
   % part 2 find phi, u, w 
   g = 9.81;
    S = 1/cosh(2*k0*h);
    alpha = 1/S;
    omega0 = sqrt(g*k0*tanh(k0*h));
    omega2Fen = (2+7*S^2)/(4*(1-S)^2);
    
    A11Fen = 1/sinh ((k0*h));
    A22Fen = 3*S^2/(2*(1-S)^2);
    A33Fen = (-2*S^2+11*S^3)/(8*sinh (k0*h)* (1-S)^3 );
    A44Fen = (10*S^3 -174*S^4 + 291*S^5 +278*S^6)/(48*(3+2*S)*(1-S)^5);
    A55Fen = (-6*S^3+272*S^4-1552*S^5+852*S^6 +2029*S^7+430*S^8)/(64 *sinh (k0*h)* (3+2*S)*(4+S)*(1-S)^6);
    
    switch modeNo
        case 1
        omega4Fen = (4+32*S - 116*S^2-400*S^3-71*S^4+146*S^5)/(32*(1-S)^5);
        A31Fen =  (-4-20*S+10*S^2-13*S^3)/8/sinh (k0*h)/(1-S)^3 ;    
        A42Fen = (12*S-14*S^2-264*S^3-45*S^4-13*S^5)/(24* (1-S)^5);
        A51Fen = (-1184 + 32*S + 13232*S^2 + 21712 *S^3 + 20940 *S^4 +12554 *S^5 -500*S^6 -3341*S^7 -670 *S^8)/(64* sinh (k0*h)* (3+2*S)*(4+S)*(1-S)^6);
        A53Fen = (4*S +105*S^2 + 198*S^3-1376*S^4 - 1302 *S^5 -117*S^6 +58*S^7)/(32*sinh (k0*h)* (3+2*S)*(1-S)^6);
        case 2
        omega4Fen = (16*alpha^5+68*alpha^4-38*alpha^3 - 250*alpha^2+55*alpha+230)/(32*(alpha-1)^5);
        A31Fen = -(alpha^2+12*alpha-7)/32/(sinh(k0*h))^5;
        A42Fen = (12*alpha^4+13*alpha^3-183*alpha^2+36*alpha+41)/24/(alpha-1)^5;
        A51Fen = -(193*alpha^6+430*alpha^5+581*alpha^4+3043*alpha^3+1574*alpha^2-251*alpha ...
            +991) /(192*(alpha-1)^6*sinh(k0*h));
        A53Fen = (8*alpha^6+156*alpha^5+495*alpha^4-1933*alpha^3-1335*alpha^2+882*alpha ...
            +512) /(64*sinh(k0*h)*(alpha-1)^6*(6*(sinh(k0*h))^2+5));
    end
    omega = omega0*(1+omega2Fen*(k0*a)^2+omega4Fen*(k0*a)^4);
    
    phi = omega/k0 *a * A11Fen*cosh(k0*(z+h))*sin(theta) + ...
        omega*a^2 * A22Fen*cosh(2*k0*(z+h))*sin(2*theta) + ...
        omega*k0 *a^3 * A31Fen*cosh(k0*(z+h))*sin(theta) + ...
        omega*k0 *a^3 * A33Fen*cosh(3*k0*(z+h))*sin(3*theta) + ...
        omega*k0^2 *a^4 * A42Fen*cosh(2*k0*(z+h))*sin(2*theta) + ...
        omega*k0^2 *a^4 * A44Fen*cosh(4*k0*(z+h))*sin(4*theta) + ...
        omega*k0^3 *a^5 * A51Fen*cosh(k0*(z+h))*sin(theta) + ...
        omega*k0^3 *a^5 * A53Fen*cosh(3*k0*(z+h))*sin(3*theta) + ...
        omega*k0^3 *a^5 * A55Fen*cosh(5*k0*(z+h))*sin(5*theta);
    u = omega*a * A11Fen*cosh(k0*(z+h))*cos(theta) + ...
        omega*a^2 * A22Fen*cosh(2*k0*(z+h))*cos(2*theta)*2*k0 + ...
        omega*k0 *a^3 * A31Fen*cosh(k0*(z+h))*cos(theta)*k0 + ...
        omega*k0 *a^3 * A33Fen*cosh(3*k0*(z+h))*cos(3*theta)*3*k0 + ...
        omega*k0^2 *a^4 * A42Fen*cosh(2*k0*(z+h))*cos(2*theta)*2*k0 + ...
        omega*k0^2 *a^4 * A44Fen*cosh(4*k0*(z+h))*cos(4*theta)*4*k0 + ...
        omega*k0^3 *a^5 * A51Fen*cosh(k0*(z+h))*cos(theta)*k0 + ...
        omega*k0^3 *a^5 * A53Fen*cosh(3*k0*(z+h))*cos(3*theta)*3*k0 + ...
        omega*k0^3 *a^5 * A55Fen*cosh(5*k0*(z+h))*cos(5*theta)*5*k0;
    w = omega*a * A11Fen*sinh(k0*(z+h))*sin(theta) + ...
        omega*a^2*A22Fen*sinh(2*k0*(z+h))*sin(2*theta)*2*k0 + ...
        omega*k0*a^3*A31Fen*sinh(k0*(z+h))*sin(theta)*k0 + ...
        omega*k0*a^3*A33Fen*sinh(3*k0*(z+h))*sin(3*theta)*3*k0 + ...
        omega*k0^2*a^4* A42Fen*sinh(2*k0*(z+h))*sin(2*theta)*2*k0 + ...
        omega*k0^2*a^4* A44Fen*sinh(4*k0*(z+h))*sin(4*theta)*4*k0 + ...
        omega*k0^3*a^5 * A51Fen*sinh(k0*(z+h))*sin(theta)*k0 + ...
        omega*k0^3*a^5 * A53Fen*sinh(3*k0*(z+h))*sin(3*theta)*3*k0 + ...
        omega*k0^3*a^5 * A55Fen*sinh(5*k0*(z+h))*sin(5*theta)*5*k0;
    phi = phi'; u = u'; w = w';
%     B22Fen   =   simplify(coth(k0*h)*(1+2*S)/(2*(1-S)));
%     B31Fen   =   simplify(-3*(1+3*S+3*S^2+2*S^3)/8/(1-S)^3);
%     B33Fen = -B31Fen;
%     B42Fen   =   coth(k0* h)*(6-26*S-182*S^2-204*S^3-25*S^4+26*S^5)/(6*(3+2*S)*(1-S)^4);
%     B44Fen   =   coth(k0*h) *(24+92*S+122*S^2+66*S^3+67*S^4+34*S^5)/(24*(3+2*S)*(1-S)^4);
%     B53Fen   =   9*(132+17*S-2216*S.^2-5897*S.^3-6292*S.^4-2687*S.^5+194*S.^6 +467*S.^7+82*S.^8)./(128*(3+2*S).*(4+S).*(1-S).^6);
%     B55Fen   =   5*(300+1579*S+3176*S.^2+2949*S.^3+1188*S.^4+675*S.^5+1326*S.^6+827*S.^7+130*S.^8)./(384*(3+2*S).*(4+S).*(1-S).^6);
%     B51Fen = -(B53Fen+B55Fen);
% 
%     eta5Fen = a*cos(theta0) + k0*a^2*B22Fen*cos(2*theta0) + ...
%         k0^2*a^3*(B31Fen*cos(theta0)+B33Fen*cos(3*theta0))+ ...
%         k0^3*a^4*(B42Fen*cos(2*theta0) + B44Fen*cos(4*theta0))+...
%         k0^4*a^5*(B51Fen*cos(theta0)+B53Fen*cos(3*theta0)+B55Fen*cos(5*theta0));
